---
title: visualising models in 3d with plotly and nse functions
author: Tom Greenwood
date: '2019-02-09'
slug: visualising-models-in-3d-with-plotly-and-nse-functions
categories:
  - R
tags:
  - functions
  - plotly
  - visualisation
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>One of the areas I’m planning to improve on is visualisation. Ultimately, this means D3, but in the meantime I wrote a fairly useful function for showing the fit of a model with two inputs, along with the data, using plotly. First, load the necessary libraries:</p>
<pre class="r"><code>library(plotly)
library(randomForest)
library(rlang)
library(dplyr)
library(magrittr)</code></pre>
<p>(you could actually write thing function without rlang or magrittr, but it’s just a bit neater with them.) Here’s the function:</p>
<pre class="r"><code>plot_3d &lt;- function(df, x, y, z) {
  
  x &lt;- enquo(x)
  y &lt;- enquo(y)
  z &lt;- enquo(z) 
  
  # build a model 
  m &lt;- randomForest(expr(!!get_expr(x) ~ !!get_expr(y) + !!get_expr(z)) %&gt;% as.formula, df)
  
  # add the predictions to df
  df %&lt;&gt;% mutate(preds = predict(m, newdata = df ))
  
  plot_ly(df) %&gt;%
    add_trace(x = x, y = y, z = z, 
                opacity = 0.7,
                type = &quot;scatter3d&quot;, 
                mode = &quot;markers&quot;,
                colors = c(&quot;grey&quot;, &quot;blue&quot;),
                name = &quot;true values&quot;,
                size = 10
              ) %&gt;%
    add_trace(x = ~preds, y = y, z = z,
                opacity = 0.7,
                type = &quot;scatter3d&quot;, 
                mode = &quot;markers&quot;,
                name = &quot;modelled values&quot;,
                size = 10
                ) %&gt;%
    layout(scene = list(xaxis = list(title = quo_text(x)),
                        yaxis = list(title = quo_text(y)),
                        zaxis = list(title = quo_text(z))
    )
    )
  
}

economics %&gt;% plot_3d(pce, psavert, uempmed)</code></pre>
<p><div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"213d3d4c21b7":["function () ","plotlyVisDat"]},"cur_data":"213d3d4c21b7","attrs":{"213d3d4c21b7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"opacity":0.7,"type":"scatter3d","mode":"markers","colors":["grey","blue"],"name":"true values","size":10,"inherit":true},"213d3d4c21b7.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"opacity":0.7,"type":"scatter3d","mode":"markers","name":"modelled values","size":10,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"pce"},"yaxis":{"title":"psavert"},"zaxis":{"title":"uempmed"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[507.4,510.5,516.3,512.9,518.1,525.8,531.5,534.2,544.9,544.6,550.4,556.8,563.8,567.6,568.8,572.3,577.4,577.2,584.2,589.5,589.7,594.7,601.1,601.7,603.5,610.8,614.1,619.4,621.4,623.7,629.6,634.9,633.2,637,643.4,647.2,649.5,653.9,660.1,659.3,657.6,666.6,677.2,680.4,683,689.8,692.2,700.8,699.9,706,714.1,716.9,722.1,729.6,732.6,737.3,750.4,753.8,759.2,762.9,771.2,777.7,782.5,796.3,801.8,807.5,817.9,827.2,834.2,837.2,843.1,845.8,855.7,854.9,870.9,869.8,878.6,878.4,886.4,891.6,903.3,912.7,924.3,929.9,939.8,956.6,956.8,961,958,963.6,977.4,991.3,992.6,997.2,1021.2,1029.1,1042.2,1049.4,1057.2,1063.2,1078,1094.4,1109.5,1110.1,1117.3,1127.8,1125.1,1142.9,1152.1,1160.5,1171.4,1179.5,1191.7,1214.1,1217.4,1233.7,1240.7,1249.7,1259.6,1266.3,1283.2,1288.5,1297.4,1314.3,1330,1339.3,1333,1358.9,1381.4,1400.2,1415.9,1429.8,1430.8,1451,1456.9,1471,1484.7,1500.5,1506.3,1521.6,1535,1542.3,1562.7,1579.6,1590.1,1619.7,1638.1,1646,1661.7,1670.7,1701.6,1705.6,1712.4,1699.5,1704.3,1723,1751.2,1767.7,1784.1,1820.4,1830.2,1855.5,1874.7,1889.4,1908.1,1909.1,1918.2,1938.5,1945.7,1969.8,1968.2,1966.2,1972.4,1989.9,1997.4,2021.4,2024.4,2027.2,2045.9,2050.2,2075.1,2083.7,2108.9,2130.7,2154.7,2167.4,2180.1,2183.1,2208.6,2231.8,2251,2280.8,2309,2324.8,2339.1,2361.8,2370.4,2397.9,2423.8,2408.1,2436.4,2462.6,2479.8,2501.2,2500.5,2518.4,2540.3,2538.2,2578.6,2590,2626.3,2648.6,2656.8,2668.4,2705.9,2699.3,2725.9,2762.7,2805.6,2767.1,2782.7,2822.8,2838.3,2831.2,2834.7,2846.5,2869,2873.5,2893.4,2911.1,2984.6,2945.9,2941.7,3010.8,2949.9,3016.5,3028.4,3054.1,3063.9,3088.4,3110.7,3147,3142.9,3151.1,3160.9,3190.9,3230.7,3238.5,3277.8,3280.4,3311,3335.6,3359.3,3384.3,3391.4,3430.4,3447,3476.3,3499.9,3503.9,3514.5,3558.6,3567.5,3582.4,3601.7,3636.8,3638.1,3650,3659.7,3700.7,3747.2,3744.8,3771.5,3786.7,3792.5,3821.3,3838.5,3865,3886.7,3887.1,3888.4,3877.8,3857.6,3883.3,3929.7,3923.9,3950,3957.1,3982.4,3985.4,4001.2,3992.9,4020.6,4037.7,4101.9,4116.8,4134.3,4149,4176.1,4195,4223,4239.3,4273.9,4303.5,4319.5,4355.6,4359.7,4374.3,4371.4,4412.4,4441.3,4458.8,4487.7,4499.9,4530.5,4552,4573.4,4590.7,4604.8,4652.3,4665.4,4690.7,4689.2,4728.8,4740.8,4783,4795.5,4833.3,4846,4862.3,4871.9,4871.7,4906.5,4911.5,4954.4,4999,4991.8,5027.1,5042.5,5035.9,5077.8,5120.1,5108.9,5156.1,5196.4,5231.6,5247.2,5253.7,5275.8,5299,5320,5351.5,5375,5401.7,5434.9,5457.7,5477.6,5482.8,5484.3,5518.2,5573,5611.8,5625.6,5661.2,5685.2,5716.4,5714.4,5748.4,5775,5812.9,5863.3,5897.2,5915.6,5951,5991.8,6025.8,6042.7,6098.2,6099.1,6128.2,6159.7,6223.6,6253.4,6281.9,6309.5,6354.8,6407.4,6431.2,6467.2,6568.2,6564.7,6648.7,6714.8,6701,6737.2,6773.6,6793.7,6828.7,6913.1,6919.6,6934.5,6979.1,7009.8,7029.3,7022.1,7036.2,7083.1,7097.1,7109.2,7146.1,7054.8,7250.2,7209.6,7190,7217.7,7259.7,7276.7,7345.6,7321.8,7366.1,7424.2,7449,7426.1,7469.3,7499.8,7552.6,7579.5,7573.6,7627.5,7661.7,7669.2,7722.9,7783.8,7878.9,7874,7890.6,7950.4,7974.3,8037.3,8072.1,8121,8141.6,8212.9,8204.6,8270.7,8294.4,8373,8417.9,8458.4,8516.5,8521.2,8575.7,8622.5,8715.9,8680.6,8775.3,8867.9,8872.6,8923.6,8959.6,8987.7,9026.8,9100.1,9134.7,9168.1,9223.3,9254.1,9283.8,9360.4,9368.6,9393.9,9413.3,9431.2,9516.5,9553.1,9590.8,9631.6,9670.6,9708.9,9723.3,9759.6,9800.6,9837.5,9853.9,9928.6,9947.6,9963.2,9955.7,10004.2,10044.6,10093.3,10149.4,10151.1,10140.3,10083.2,9983.3,9851.2,9744.2,9792.1,9775.7,9742.9,9741.9,9759.7,9807.6,9835.2,9961.9,9875.4,9924.6,9946.1,10000.6,10003.4,10034.7,10095.5,10106.9,10140.2,10165.9,10184.3,10247.1,10268.9,10343.7,10399.8,10436.1,10474.7,10512.4,10583.5,10624.6,10653.1,10676.4,10727.1,10745.6,10790.6,10827.6,10828.7,10827.3,10905.5,10979.2,10994.3,11030.2,11029,11032.5,11074.8,11104.8,11179.6,11199.9,11222.8,11245.2,11303.2,11371.4,11378.8,11373.3,11407.1,11462.4,11484.7,11511.6,11559.6,11602.1,11671.5,11686.3,11663.9,11714.4,11807.1,11825.2,11864.3,11922.6,11944.4,12017,12044.6,12096.4,12142.2,12122,12080.8,12095.9,12161.5,12158.9],"y":[12.5,12.5,11.7,12.5,12.5,12.1,11.7,12.2,11.6,12.2,12,11.6,10.6,10.4,10.4,10.6,10.4,10.9,10,9.4,9.9,9.5,10,10.9,11.7,11.5,11.5,11.3,11.5,11.7,11.7,11.6,12.3,13.3,12.3,11.7,13.2,13.1,12.9,13,13.3,12.9,13.1,13.1,13.3,13,13.4,14.4,13.6,13.6,12.9,13,12.8,12.9,12.4,12.6,11.5,11.3,11.5,11.4,11.4,11.8,12,12.7,13.4,13.4,12.1,12.2,12.4,12.8,12.8,13.2,12.8,13.6,12.8,14,14,14.4,14,13.8,13,12.7,12.3,12.5,12.7,11.6,12.3,13,13.4,13.6,12.8,12.1,12.3,13.9,17,13.9,12.3,12.6,12.6,13,12.3,11.5,11.3,11.9,11.8,11.2,11.8,10.9,11.2,11.2,10.8,10.6,10.9,9.9,9.8,8.5,9.8,9.9,9.8,10.2,10.1,10.5,10.7,10.7,10.8,11,11.4,10.7,10.5,10.3,9.8,9.5,10.3,9.9,10,10.2,10,10,10.6,10.5,10.7,10.4,9.8,9.3,10,9.2,8.9,9.3,9.4,9.8,9.6,9.8,9.8,10.5,10.6,10.4,10.5,10.6,11.1,11,11.5,11.2,10.5,10.4,10.3,10.3,10.4,10.2,11.7,11.4,11.9,12.5,12.7,12,12.2,11.6,11.7,12.4,11.7,11.6,12,11.9,11.1,10.7,10.3,10.3,10.4,10.5,10,9.6,9.4,8.5,9,8.7,9,9.1,9.7,9.5,9.4,11.1,10.9,10.9,10.5,10.5,11,11.2,11.2,11.2,10.3,10.6,9.7,8.5,8.1,9.4,10.5,9,8.5,7.5,6.7,8.5,8.4,8,8,8.7,9.3,9.1,8.6,8.8,8.7,8.4,6.6,7.8,8.2,6.4,9.1,7.9,7.9,3.8,7.5,7,6.8,6.5,7,7.6,7.9,8,7.5,7.9,7.5,8.1,7.7,7.8,7.9,7.8,8.2,8,7.7,7.7,8,8.4,8.9,7.9,7.6,7.6,7.7,7.1,7.5,7.9,8,7.2,7.4,8.1,7.8,8.2,8,7.9,8,7.5,7.5,7.3,7.4,8.2,8.7,8.3,7.4,8,7.7,8.2,7.6,7.9,8.1,8.6,8.4,9.1,8.8,9.2,9.2,9.4,9.4,9.5,9.1,9.2,8.2,7.4,7.3,9.9,8.3,8.4,8.3,8.2,7.7,7.2,7,7.1,6.3,5.6,5.6,8.4,6.4,5.9,6.2,5.8,7.1,6.3,6.4,5.9,6.2,6.5,6.4,6.5,6.9,7.3,7,6.3,6.5,6.1,6.4,6.1,6.1,6.5,6,5.5,6.1,6.1,6,5,6.1,6.5,6.1,5.9,6,5.8,5.8,5.7,5.6,5.7,5.8,5.9,6.2,6,5.5,5.4,5.6,5.6,5.8,5.8,6.7,6.8,6.9,6.6,6.3,6.2,6.3,6.2,5.8,5.6,5.7,5.2,5.7,5.6,5.3,4.5,4.3,4.2,4.1,4,3.5,3.9,4.1,3.7,4.7,4.2,3.9,4.4,4.2,4.2,4.6,4.6,3.8,4,3.8,3.5,4,4.1,4.5,4.3,3.7,3.7,5,6.1,6.3,2.7,3.4,3.8,5.6,5.3,5.3,5.1,5.6,5.4,4.6,4.4,4.9,4.7,4.7,4.5,4.5,4.7,4.6,4.6,5.1,4.9,5.5,5.3,4.5,4.6,4.7,4.8,4.5,4.5,4.5,4.7,4.7,5,4.5,4.6,3.9,3.8,3.4,6.3,2.9,2.7,2.7,2.1,3,2.2,1.9,2.4,2.3,2.6,2.7,2.8,3.7,3.8,3.7,3.4,3.2,3.4,2.9,3,3,3.1,3.2,3,3,3.3,3.6,3.2,3,2.8,2.8,2.6,2.8,2.8,2.5,3,3.4,3.9,4,3.5,7.9,5.6,4.4,3.7,4.4,5.4,6.3,6.5,6.5,5.9,6.1,6.7,8.1,6.7,6,4.9,5.9,5.4,5.7,5.7,5.6,5.2,5,5.6,6,5.9,5.9,5.8,5.6,5.4,5.3,5.9,6.2,6.4,6,5.9,5.9,6.1,6.3,6.2,5.7,5.5,5.6,6.4,6.6,6.7,6.9,7,7,7.1,6.6,6.4,6.5,7.1,8.2,10.5,4.5,4.7,4.9,5.1,5.2,5.3,5.1,5.3,5.2,4.7,4.3,4.1,4.9,5,4.8,5,5.1,5.1,5.1,4.7,4.6,4.6,4.5,5,5.5,5.7,5.2,5.6],"z":[4.5,4.7,4.6,4.9,4.7,4.8,5.1,4.5,4.1,4.6,4.4,4.4,4.5,4.2,4.6,4.8,4.4,4.4,4.4,4.9,4,4,4.2,4.4,4.4,4.4,4.7,4.5,4.8,4.6,4.6,4.5,4.6,4.1,4.7,4.9,5.1,5.4,5.2,5.2,5.6,5.9,6.2,6.3,6.4,6.5,6.7,5.7,6.2,6.4,5.8,6.5,6.4,6.2,6.2,6.6,6.6,6.7,6.6,5.4,6.1,6,5.6,5.7,5.7,6.1,5.7,5.2,5.5,5,4.9,5,5.2,4.9,5.4,5.5,5.1,4.7,5,5.1,4.8,5,4.6,5.3,5.7,5,5.3,5.5,5.2,5.7,6.3,7.1,7.2,8.7,9.4,8.8,8.6,9.2,9.2,8.6,9.5,9,9,8.2,8.7,8.2,8.3,7.8,7.7,7.9,7.8,7.7,8.4,8,7.5,7.2,7.2,7.3,7.9,6.2,7.1,7,6.7,6.9,7,6.8,6.5,6.7,6.2,6.1,5.7,6,5.8,5.8,5.6,5.9,5.5,5.6,5.9,5.9,5.9,5.4,5.6,5.6,5.9,4.8,5.5,5.5,5.3,5.7,5.3,5.8,6,5.8,5.7,6.4,7,7.5,7.7,7.5,7.7,7.5,7.4,7.1,7.1,7.4,6.9,6.6,7.1,7.2,6.8,6.8,6.9,6.9,7.1,7.5,7.7,8.1,8.5,9.5,8.5,8.7,9.5,9.7,10,10.2,11.1,9.8,10.4,10.9,12.3,11.3,10.1,9.3,9.3,9.4,9.3,8.7,9.1,8.3,8.3,8.2,9.1,7.5,7.5,7.3,7.6,7.2,7.2,7.3,6.8,7.1,7.1,6.9,6.9,6.6,6.9,7.1,6.9,7.1,7,6.8,6.7,6.9,6.8,6.7,6.8,7,6.9,7.1,7.4,7,7.1,7.1,6.9,6.6,6.6,7.1,6.6,6.5,6.5,6.4,6,6.3,6.2,6,6.2,6.3,6.4,5.9,5.9,5.8,6.1,5.9,5.7,5.6,5.7,5.9,5.6,5.4,5.4,5.4,5.3,5.4,5.6,5,4.9,4.9,4.8,4.9,5.1,5.3,5.1,4.8,5.2,5.2,5.4,5.4,5.6,5.8,5.7,5.9,6,6.2,6.7,6.6,6.4,6.9,7,7.3,6.8,7.2,7.5,7.8,8.1,8.2,8.3,8.5,8.8,8.7,8.6,8.8,8.6,9,9,9.3,8.6,8.5,8.5,8.4,8.1,8.3,8.2,8.2,8.3,8,8.3,8.3,8.6,9.2,9.3,9.1,9.2,9.3,9,8.9,9.2,10,9,8.7,8,8.1,8.3,8.3,9.1,7.9,8.5,8.3,7.9,8.2,8,8.3,8.3,7.8,8.3,8.6,8.6,8.3,8.3,8.4,8.5,8.3,7.7,7.8,7.8,8.1,7.9,8.3,8,8,8.3,7.8,8.2,7.7,7.6,7.5,7.4,7,6.8,6.7,6,6.9,6.7,6.8,6.7,5.8,6.6,6.8,6.9,6.8,6.8,6.2,6.5,6.3,5.8,6.5,6,6.1,6.2,5.8,5.8,6.1,6,6.1,5.8,5.7,6,6.3,5.2,6.1,6.1,6,5.8,6.1,6.6,5.9,6.3,6,6.8,6.9,7.2,7.3,7.7,8.2,8.4,8.3,8.4,8.9,9.5,11,8.9,9,9.5,9.6,9.3,9.6,9.6,9.5,9.7,10.2,9.9,11.5,10.3,10.1,10.2,10.4,10.3,10.4,10.6,10.2,10.2,9.5,9.9,11,8.9,9.2,9.6,9.5,9.7,9.5,9.4,9.2,9.3,9,9.1,9,8.8,9.2,8.4,8.6,8.5,8.7,8.6,9.1,8.7,8.4,8.5,7.3,8,8.4,8,7.9,8.3,7.5,8.3,8.5,9.1,8.6,8.2,7.7,8.7,8.8,8.7,8.4,8.6,8.4,9,8.7,8.7,9.4,7.9,9,9.7,9.7,10.2,10.4,9.8,10.5,10.7,11.7,12.3,13.1,14.2,17.2,16,16.3,17.8,18.9,19.8,20.1,20,19.9,20.4,22.1,22.3,25.2,22.3,21,20.3,21.2,21,21.9,21.6,21.1,21.5,20.9,21.6,22.3,22,22.4,22,20.5,20.9,20.5,21,19.8,19.2,19.1,19.9,20.1,17.5,18.5,18.8,19.7,18.5,17.6,16.2,17.5,17.7,17.1,17,16.6,16.3,16.8,16.5,16.1,17,17,15.9,16.2,15.9,15.6,14.5,13.2,13.5,13.3,13.3,13.5,12.8,12.6,13.4,13.1,12.2,11.7],"opacity":0.7,"type":"scatter3d","mode":"markers","name":"true values","marker":{"color":"rgba(31,119,180,1)","size":[55],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"textfont":{"size":55},"error_y":{"color":"rgba(31,119,180,1)","width":55},"error_x":{"color":"rgba(31,119,180,1)","width":55},"line":{"color":"rgba(31,119,180,1)","width":55},"frame":null},{"x":[562.005296998557,579.11808406205,605.391536475193,657.981643427128,579.11808406205,649.636449776334,703.446412164503,566.876268015874,582.763082222221,599.523905104341,582.792328562451,592.429417545134,607.115458492063,593.660721349207,602.403926951382,693.242968030302,594.00392295639,598.949680337343,606.742813237775,1108.759969329,631.583516666667,795.018666666668,608.043166825397,598.949680337343,590.003396455669,598.596680520492,615.766235421246,632.360203809523,665.047841705516,605.391536475193,605.391536475193,604.94454063492,701.208456374181,655.985727619048,662.211551349206,661.048575497836,752.244101904762,796.694267954824,760.44472021645,765.304515851371,761.069757103174,770.928256948329,717.926086161616,745.979157142858,709.778864920635,751.502447777777,862.485061365857,818.065002829113,749.131016637807,734.54243968254,787.002232285458,751.502447777777,798.051992539682,738.829986875901,812.031428542567,840.769181117215,840.551130189256,1016.94252541348,840.551130189256,913.690398907205,936.633180659342,892.92539368687,846.629892341269,893.633095210067,836.880556876734,807.033973278389,841.515014257687,826.611967756134,864.433957417582,863.611289834055,818.859375865801,825.581600158729,841.171807272729,850.269558809524,901.113617153958,870.739691703296,868.720349047618,796.262505,882.639497301588,867.274149523808,814.203621839825,887.808657301588,701.208456374181,917.063888253968,893.633095210067,811.535077936507,931.61508190476,853.344419957265,863.607729978354,856.743433781496,868.774153246755,1504.39449428571,1469.67504157287,1156.01594257937,1277.62098714286,1225.092565,1347.75534256133,1173.67128532468,1173.67128532468,1227.97902145022,1464.09505547619,1356.39819573871,1348.63121666667,1519.36310857143,1509.57474972222,1580.36184475469,1596.71041307412,1429.88723317461,1546.77131171717,1543.00256170274,1338.64984809524,1495.7183680303,1862.61567404761,1581.27315952381,1439.94714737374,2546.06220059163,1477.30110583694,1500.019665,1650.57202989899,1400.5765818759,1441.78476063492,1718.31825173882,1394.05335549284,1664.33518300654,1447.05628055556,1659.20591964591,1020.71912952381,1394.05335549284,1451.36977560606,1447.68883240537,1563.86892802392,1690.12505321068,1530.38074194636,1523.94962234318,1493.95924980159,1510.15501440865,1484.6214264652,1493.95924980159,1552.70591504357,1560.00209194833,1486.08903424992,1528.51259128816,1561.47558271645,1723.26894662698,1532.74409790071,1895.60477382395,2419.99684071484,1717.72426162393,1717.288004329,1563.86892802392,1656.07941523809,1606.0008505755,1638.74822834777,1593.01610869239,1559.92976949578,1592.14311063492,1718.31825173882,1981.14507382395,1653.04261406205,2033.7221648557,1740.58346884838,2120.44134203463,2064.61978150072,1849.29097333333,1892.89485555555,2055.03555722222,2013.19900604405,1660.08148778388,1838.27600238095,1926.42779189033,1787.563264884,1724.01014377289,1712.59329292717,1868.48143340336,1577.11941809524,1968.42964072872,1816.17598453824,1708.020495,1829.43011603175,1859.7831865873,1834.43934269841,1620.3465106746,2112.53943928572,2369.70046333333,2235.80113746032,2329.38269857143,2422.34716642857,2447.43604777056,2527.44988301588,2629.15107666667,3833.66206623376,2943.51627806638,2436.69313333333,2663.91654071429,2553.887295,2569.73512150794,2780.14280928571,3199.22220734127,2900.97404432901,2153.07090497888,2146.47201934396,1970.44879484127,2327.64778189755,2122.39617945166,2033.7221648557,2318.2533736075,2209.38178717894,2230.68848454546,2173.9887967316,2217.64549777778,2306.98169940782,2587.88722443723,2965.61976827562,2677.83033561115,2047.65870960827,2760.29411445056,2666.18725817248,3022.63817720779,4242.48509145531,2587.88722443723,3100.74232753968,3223.14007610335,3150.38495282329,2972.85494978864,2704.17635655067,2868.29239628649,3011.88678551892,2956.90017746032,2972.85494978864,2961.79821137085,4270.68540666667,3271.26981246031,3086.92079285714,4120.73308089467,2914.74865947119,3184.15865339494,3184.15865339494,5177.92284779222,3214.93934263958,3474.27915611111,3774.92298261904,3958.21731260462,3581.62339189754,3290.22909738096,3250.68560328061,3363.96330501443,3250.81499109668,3251.08830148407,3344.0633830303,3439.25570026723,3433.86736471168,3396.2362016289,3265.49477317516,3366.6370269339,3576.10111033549,3505.27844319264,3500.6260656746,3433.86736471168,3505.27844319264,3485.76628109334,2857.53051323621,3642.85004702187,3616.66829523809,3616.53829014097,3556.23548615079,3739.88445801588,3618.322406443,3630.76014791264,3524.48037180374,3682.70508595238,3706.24505063492,3660.89109214286,3643.19977571429,3547.89569942279,3727.2062425469,3732.46835524309,3657.40940043678,3721.81979340936,3690.74687092712,3778.21745591461,3792.60518376983,3627.0583081821,3297.46771813132,3695.33447822512,3661.51861295315,3364.72697220668,3530.41684507937,3605.32900897334,3502.6403329365,4000.88060913197,3484.35221297924,3191.63567823953,3883.87131484127,4025.69205206349,3943.49337039682,4065.09402333334,4095.01293430391,3721.87085202742,3703.42850766234,3199.22220734127,3984.61189105339,4028.08584785715,4415.19086746032,4394.70257515873,4448.23400261904,3070.40431428572,4378.19525954546,4323.11295769842,4391.26178722223,4434.77503616883,4832.60195452381,4568.58901407694,4685.46402621489,4688.40743573871,5059.91169935805,5274.13645434399,5324.34610892269,4393.21887873859,4856.01118982018,5082.07162754079,5017.61979478355,5213.95767606338,4699.13672786436,5265.30007987789,4875.23274753968,5159.03632316849,4999.78366582251,6759.2986764935,4875.23274753968,5045.77223211206,5040.18616261904,4653.54386309524,4738.37933584705,5059.91169935805,4981.22466140693,5301.80099526695,4985.15316246032,5179.37526933363,5301.80099526695,5000.45889055833,5315.21162436508,5508.69247815014,5179.37526933363,5268.37888616162,5257.19628106523,6598.45617061384,5255.35240651571,4990.35260411586,5179.37526933363,5568.78253313076,5377.42089571429,5329.78125282846,5592.01333828561,5492.97723609668,5472.83864696303,5404.93727292208,5494.44734279498,5367.52428137658,5296.0614219264,5315.21162436508,5508.69247815014,5905.66052007936,5436.77030505827,5682.0616921362,5706.39141255689,5746.71115255689,4598.43733690476,4707.81390722221,5044.14361227994,4818.70525443223,5718.11055820401,6060.57543396613,6005.01818844933,6032.15951484127,5998.63657072427,5973.99000517201,6024.76469554112,6316.4696272006,6105.251020438,6063.79937710013,6324.30032529584,6495.91911176768,6370.82151261904,6498.53325380952,6624.9957982162,6393.39227119047,6846.1585600505,6689.49986221779,6467.60489833334,6780.6983182162,6665.39515136195,6727.4674565035,6695.74380084416,6793.70776951938,6662.24605702572,6517.78405345239,6740.6844279293,6671.46209476191,6395.52837422079,6796.52323031302,6698.62295548618,6846.1585600505,6743.79921559715,6745.30446483683,6693.16841510102,6791.34604784661,6851.46225714287,6857.13922719337,6643.10489354981,6274.85501575546,6174.24812035407,8085.56054619049,8171.91079714286,7350.89086080808,6854.49043557609,6625.31797858852,7044.50201916862,7472.96395750362,7859.87306316627,8272.56501428572,7735.64035650794,8298.92309611112,7552.70715309525,7668.72286195527,7672.6000032251,7725.67984897713,7725.67984897713,7712.94624711401,7903.74616,7913.39260730158,7801.76823813853,8323.0545406349,8104.84958833332,7840.34911238094,8034.66479477078,8024.16165023809,7941.63690933621,8083.66290706348,8196.93963929457,8034.66479477078,8034.66479477078,7712.94624711401,7951.39849528858,7958.96359095239,7871.33095743313,7891.47178413418,8714.58544730159,8669.37715287157,9174.23355706348,7118.41282249694,8842.97046238096,8652.62235294372,8566.53852523809,8831.23355730158,8924.87345301588,8831.59435730158,9081.75215825396,8734.02543532467,9084.34135456545,9248.98246497891,9075.26068222223,9513.09255721305,9104.02123640749,9013.45826183984,9404.3868818956,9286.34460981073,9354.00165126984,7976.48839301586,9197.59543349205,9526.87872887279,9229.64965652237,9175.01225541125,9160.88734566006,8883.96866190476,9212.55735646815,9370.1255679365,9390.62838404762,9372.65509355034,9237.65326636364,8972.7283190476,9513.09255721305,9414.01237444444,9513.09255721305,9551.59819504883,9415.91458355034,9526.87872887279,9322.56839912699,9533.82997332421,9559.18326332421,9295.61831904761,6972.63851556053,8013.38102962536,9234.190035,9498.02331738094,9359.83000666668,8565.71453666666,8074.0110867033,8856.07053878788,8911.73943545455,9973.02860332724,9746.60824793651,10150.2626602381,8875.95673619049,10190.1997669048,10088.9279468254,10924.7604249206,10113.6207670141,10242.4881066667,10152.3631821428,10140.4084754762,10127.1481897619,10324.9824204762,10448.5413542857,10377.155267381,10268.5897487302,10241.4497888395,10247.5703605062,10299.5296538095,10262.0898997619,10350.2871166667,10453.5596433333,10425.62776003,10550.9402078788,10657.52832,10427.6339834921,10493.7196733633,10450.4121309823,10445.135102381,10634.9328162271,10560.9337912121,10543.8082788095,10547.1566547619,10518.9970964286,10767.1363233333,10813.3036966667,10761.0415902381,10968.4297666667,10939.4559634921,10879.6702001587,10790.3688434921,10717.34948,10901.96402,10896.3157937229,10855.1716501587,10385.2795887879,8857.83950809526,11464.9555812121,11353.790942114,11000.236888254,11440.1030890909,11429.2685171428,11367.5542833333,11339.0975257576,11369.17734,11447.5018604762,11512.6012978283,11502.92466,11477.1257966667,11480.4609287302,11442.8843604762,11691.9126880952,11722.7178828572,11845.8970788528,11913.40843171,11934.8189050433,11889.8770506854,11932.8439080952,11946.1184580952,11858.0339062121,11793.0271038095,11675.1977480952,11326.398797381,11399.0830309524,10843.9461058791],"y":[12.5,12.5,11.7,12.5,12.5,12.1,11.7,12.2,11.6,12.2,12,11.6,10.6,10.4,10.4,10.6,10.4,10.9,10,9.4,9.9,9.5,10,10.9,11.7,11.5,11.5,11.3,11.5,11.7,11.7,11.6,12.3,13.3,12.3,11.7,13.2,13.1,12.9,13,13.3,12.9,13.1,13.1,13.3,13,13.4,14.4,13.6,13.6,12.9,13,12.8,12.9,12.4,12.6,11.5,11.3,11.5,11.4,11.4,11.8,12,12.7,13.4,13.4,12.1,12.2,12.4,12.8,12.8,13.2,12.8,13.6,12.8,14,14,14.4,14,13.8,13,12.7,12.3,12.5,12.7,11.6,12.3,13,13.4,13.6,12.8,12.1,12.3,13.9,17,13.9,12.3,12.6,12.6,13,12.3,11.5,11.3,11.9,11.8,11.2,11.8,10.9,11.2,11.2,10.8,10.6,10.9,9.9,9.8,8.5,9.8,9.9,9.8,10.2,10.1,10.5,10.7,10.7,10.8,11,11.4,10.7,10.5,10.3,9.8,9.5,10.3,9.9,10,10.2,10,10,10.6,10.5,10.7,10.4,9.8,9.3,10,9.2,8.9,9.3,9.4,9.8,9.6,9.8,9.8,10.5,10.6,10.4,10.5,10.6,11.1,11,11.5,11.2,10.5,10.4,10.3,10.3,10.4,10.2,11.7,11.4,11.9,12.5,12.7,12,12.2,11.6,11.7,12.4,11.7,11.6,12,11.9,11.1,10.7,10.3,10.3,10.4,10.5,10,9.6,9.4,8.5,9,8.7,9,9.1,9.7,9.5,9.4,11.1,10.9,10.9,10.5,10.5,11,11.2,11.2,11.2,10.3,10.6,9.7,8.5,8.1,9.4,10.5,9,8.5,7.5,6.7,8.5,8.4,8,8,8.7,9.3,9.1,8.6,8.8,8.7,8.4,6.6,7.8,8.2,6.4,9.1,7.9,7.9,3.8,7.5,7,6.8,6.5,7,7.6,7.9,8,7.5,7.9,7.5,8.1,7.7,7.8,7.9,7.8,8.2,8,7.7,7.7,8,8.4,8.9,7.9,7.6,7.6,7.7,7.1,7.5,7.9,8,7.2,7.4,8.1,7.8,8.2,8,7.9,8,7.5,7.5,7.3,7.4,8.2,8.7,8.3,7.4,8,7.7,8.2,7.6,7.9,8.1,8.6,8.4,9.1,8.8,9.2,9.2,9.4,9.4,9.5,9.1,9.2,8.2,7.4,7.3,9.9,8.3,8.4,8.3,8.2,7.7,7.2,7,7.1,6.3,5.6,5.6,8.4,6.4,5.9,6.2,5.8,7.1,6.3,6.4,5.9,6.2,6.5,6.4,6.5,6.9,7.3,7,6.3,6.5,6.1,6.4,6.1,6.1,6.5,6,5.5,6.1,6.1,6,5,6.1,6.5,6.1,5.9,6,5.8,5.8,5.7,5.6,5.7,5.8,5.9,6.2,6,5.5,5.4,5.6,5.6,5.8,5.8,6.7,6.8,6.9,6.6,6.3,6.2,6.3,6.2,5.8,5.6,5.7,5.2,5.7,5.6,5.3,4.5,4.3,4.2,4.1,4,3.5,3.9,4.1,3.7,4.7,4.2,3.9,4.4,4.2,4.2,4.6,4.6,3.8,4,3.8,3.5,4,4.1,4.5,4.3,3.7,3.7,5,6.1,6.3,2.7,3.4,3.8,5.6,5.3,5.3,5.1,5.6,5.4,4.6,4.4,4.9,4.7,4.7,4.5,4.5,4.7,4.6,4.6,5.1,4.9,5.5,5.3,4.5,4.6,4.7,4.8,4.5,4.5,4.5,4.7,4.7,5,4.5,4.6,3.9,3.8,3.4,6.3,2.9,2.7,2.7,2.1,3,2.2,1.9,2.4,2.3,2.6,2.7,2.8,3.7,3.8,3.7,3.4,3.2,3.4,2.9,3,3,3.1,3.2,3,3,3.3,3.6,3.2,3,2.8,2.8,2.6,2.8,2.8,2.5,3,3.4,3.9,4,3.5,7.9,5.6,4.4,3.7,4.4,5.4,6.3,6.5,6.5,5.9,6.1,6.7,8.1,6.7,6,4.9,5.9,5.4,5.7,5.7,5.6,5.2,5,5.6,6,5.9,5.9,5.8,5.6,5.4,5.3,5.9,6.2,6.4,6,5.9,5.9,6.1,6.3,6.2,5.7,5.5,5.6,6.4,6.6,6.7,6.9,7,7,7.1,6.6,6.4,6.5,7.1,8.2,10.5,4.5,4.7,4.9,5.1,5.2,5.3,5.1,5.3,5.2,4.7,4.3,4.1,4.9,5,4.8,5,5.1,5.1,5.1,4.7,4.6,4.6,4.5,5,5.5,5.7,5.2,5.6],"z":[4.5,4.7,4.6,4.9,4.7,4.8,5.1,4.5,4.1,4.6,4.4,4.4,4.5,4.2,4.6,4.8,4.4,4.4,4.4,4.9,4,4,4.2,4.4,4.4,4.4,4.7,4.5,4.8,4.6,4.6,4.5,4.6,4.1,4.7,4.9,5.1,5.4,5.2,5.2,5.6,5.9,6.2,6.3,6.4,6.5,6.7,5.7,6.2,6.4,5.8,6.5,6.4,6.2,6.2,6.6,6.6,6.7,6.6,5.4,6.1,6,5.6,5.7,5.7,6.1,5.7,5.2,5.5,5,4.9,5,5.2,4.9,5.4,5.5,5.1,4.7,5,5.1,4.8,5,4.6,5.3,5.7,5,5.3,5.5,5.2,5.7,6.3,7.1,7.2,8.7,9.4,8.8,8.6,9.2,9.2,8.6,9.5,9,9,8.2,8.7,8.2,8.3,7.8,7.7,7.9,7.8,7.7,8.4,8,7.5,7.2,7.2,7.3,7.9,6.2,7.1,7,6.7,6.9,7,6.8,6.5,6.7,6.2,6.1,5.7,6,5.8,5.8,5.6,5.9,5.5,5.6,5.9,5.9,5.9,5.4,5.6,5.6,5.9,4.8,5.5,5.5,5.3,5.7,5.3,5.8,6,5.8,5.7,6.4,7,7.5,7.7,7.5,7.7,7.5,7.4,7.1,7.1,7.4,6.9,6.6,7.1,7.2,6.8,6.8,6.9,6.9,7.1,7.5,7.7,8.1,8.5,9.5,8.5,8.7,9.5,9.7,10,10.2,11.1,9.8,10.4,10.9,12.3,11.3,10.1,9.3,9.3,9.4,9.3,8.7,9.1,8.3,8.3,8.2,9.1,7.5,7.5,7.3,7.6,7.2,7.2,7.3,6.8,7.1,7.1,6.9,6.9,6.6,6.9,7.1,6.9,7.1,7,6.8,6.7,6.9,6.8,6.7,6.8,7,6.9,7.1,7.4,7,7.1,7.1,6.9,6.6,6.6,7.1,6.6,6.5,6.5,6.4,6,6.3,6.2,6,6.2,6.3,6.4,5.9,5.9,5.8,6.1,5.9,5.7,5.6,5.7,5.9,5.6,5.4,5.4,5.4,5.3,5.4,5.6,5,4.9,4.9,4.8,4.9,5.1,5.3,5.1,4.8,5.2,5.2,5.4,5.4,5.6,5.8,5.7,5.9,6,6.2,6.7,6.6,6.4,6.9,7,7.3,6.8,7.2,7.5,7.8,8.1,8.2,8.3,8.5,8.8,8.7,8.6,8.8,8.6,9,9,9.3,8.6,8.5,8.5,8.4,8.1,8.3,8.2,8.2,8.3,8,8.3,8.3,8.6,9.2,9.3,9.1,9.2,9.3,9,8.9,9.2,10,9,8.7,8,8.1,8.3,8.3,9.1,7.9,8.5,8.3,7.9,8.2,8,8.3,8.3,7.8,8.3,8.6,8.6,8.3,8.3,8.4,8.5,8.3,7.7,7.8,7.8,8.1,7.9,8.3,8,8,8.3,7.8,8.2,7.7,7.6,7.5,7.4,7,6.8,6.7,6,6.9,6.7,6.8,6.7,5.8,6.6,6.8,6.9,6.8,6.8,6.2,6.5,6.3,5.8,6.5,6,6.1,6.2,5.8,5.8,6.1,6,6.1,5.8,5.7,6,6.3,5.2,6.1,6.1,6,5.8,6.1,6.6,5.9,6.3,6,6.8,6.9,7.2,7.3,7.7,8.2,8.4,8.3,8.4,8.9,9.5,11,8.9,9,9.5,9.6,9.3,9.6,9.6,9.5,9.7,10.2,9.9,11.5,10.3,10.1,10.2,10.4,10.3,10.4,10.6,10.2,10.2,9.5,9.9,11,8.9,9.2,9.6,9.5,9.7,9.5,9.4,9.2,9.3,9,9.1,9,8.8,9.2,8.4,8.6,8.5,8.7,8.6,9.1,8.7,8.4,8.5,7.3,8,8.4,8,7.9,8.3,7.5,8.3,8.5,9.1,8.6,8.2,7.7,8.7,8.8,8.7,8.4,8.6,8.4,9,8.7,8.7,9.4,7.9,9,9.7,9.7,10.2,10.4,9.8,10.5,10.7,11.7,12.3,13.1,14.2,17.2,16,16.3,17.8,18.9,19.8,20.1,20,19.9,20.4,22.1,22.3,25.2,22.3,21,20.3,21.2,21,21.9,21.6,21.1,21.5,20.9,21.6,22.3,22,22.4,22,20.5,20.9,20.5,21,19.8,19.2,19.1,19.9,20.1,17.5,18.5,18.8,19.7,18.5,17.6,16.2,17.5,17.7,17.1,17,16.6,16.3,16.8,16.5,16.1,17,17,15.9,16.2,15.9,15.6,14.5,13.2,13.5,13.3,13.3,13.5,12.8,12.6,13.4,13.1,12.2,11.7],"opacity":0.7,"type":"scatter3d","mode":"markers","name":"modelled values","marker":{"color":"rgba(255,127,14,1)","size":[55],"sizemode":"area","line":{"color":"rgba(255,127,14,1)"}},"textfont":{"size":55},"error_y":{"color":"rgba(255,127,14,1)","width":55},"error_x":{"color":"rgba(255,127,14,1)","width":55},"line":{"color":"rgba(255,127,14,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
Look’s like random forrest models are pretty decent for non-linear regression!</p>
